<div class="container">

<table style="width: 100%;"><tr>
<td>qch.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Infer posterior probabilities of <code class="reqn">H_0</code>/<code class="reqn">H_1</code> configurations.</h2>

<h3>Description</h3>

<p>For each item, estimate the posterior probability for each configuration.
This function use either the model accounting for the dependence structure
through a Gaussian copula function (<code>copula=="gaussian"</code>) or
assuming the conditional independence (<code>copula=="indep"</code>).
Utilizes parallel computing, when available. For package documentation, see <code>qch-package</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qch.fit(
  pValMat,
  EffectMat = NULL,
  Hconfig,
  copula = "indep",
  threads_nb = 0,
  plotting = FALSE,
  Precision = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pValMat</code></td>
<td>
<p>A matrix of p-values, each column corresponding to a p-value serie.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EffectMat</code></td>
<td>
<p>A matrix of estimated effects corresponding to the p-values contained in pValMat. If specified, the procedure will account for the direction of the effect. (optional, default is <code>NULL</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hconfig</code></td>
<td>
<p>A list of all possible combination of <code class="reqn">H_0</code> and <code class="reqn">H_1</code> hypotheses generated by the <code>GetHconfig()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>A string specifying the form of copula to use. Possible values are "<code>indep</code>"and "<code>gaussian</code>". Default is "<code>indep</code>" corresponding to the independent case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads_nb</code></td>
<td>
<p>The number of threads to use. The number of thread will set to the number of core available by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotting</code></td>
<td>
<p>A boolean. Should some diagnostic graphs be plotted ? Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Precision</code></td>
<td>
<p>The precision for EM algorithm to infer the parameters. Default is <code>1e-6</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>prior</code> </td>
<td style="text-align: left;"> vector of estimated prior probabilities
for each of the H-configurations.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Rcopula</code> </td>
<td style="text-align: left;"> the estimated correlation matrix of the Gaussian copula.
(if applicable)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Hconfig</code> </td>
<td style="text-align: left;"> the list of all configurations.
</td>
</tr>
</table>
<ul>
<li>
<p> If the storage permits, the list will additionally contain:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>posterior</code> </td>
<td style="text-align: left;"> matrix providing for each item (in row) its posterior probability to
belong to each of the H-configurations (in columns).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>fHconfig</code> </td>
<td style="text-align: left;"> matrix containing <code class="reqn">\psi_c</code> densities evaluated at each items,
each column corresponding to a configuration.
</td>
</tr>
</table>
</li>
<li>
<p> Else, the list will additionally contain:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>f0Mat</code> </td>
<td style="text-align: left;"> matrix containing the evaluation of the marginal densities under <code class="reqn">H_0</code> at each items,
each column corresponding to a p-value serie.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>f1Mat</code> </td>
<td style="text-align: left;"> matrix containing the evaluation of the marginal densities under <code class="reqn">H_1</code> at each items,
each column corresponding to a p-value serie.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>F0Mat</code> </td>
<td style="text-align: left;"> matrix containing the evaluation of the marginal cdf under <code class="reqn">H_0</code> at each items,
each column corresponding to a p-value serie.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>F1Mat</code> </td>
<td style="text-align: left;"> matrix containing the evaluation of the marginal cdf under <code class="reqn">H_1</code> at each items,
each column corresponding to a p-value serie.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>fHconfig_sum</code> </td>
<td style="text-align: left;"> vector containing <code class="reqn">(\sum_cw_c\psi_c(Z_i))</code> for each items <code class="reqn">i</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</li>
</ul>
<p>The elements of interest are the posterior probabilities matrix, <code>posterior</code>,
the estimated proportion of observations belonging to each configuration, <code>prior</code>, and
the estimated correlation matrix of the Gaussian copula, <code>Rcopula</code>.
The remaining elements are returned primarily for use by other functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PvalSets_cor)
PvalMat &lt;- as.matrix(PvalSets_cor[,-3])
## Build the Hconfig objects
Q &lt;- 2
Hconfig &lt;- GetHconfig(Q)

## Run the function
res.fit &lt;- qch.fit(pValMat = PvalMat,Hconfig = Hconfig,copula="gaussian")

## Display the prior of each class of items
res.fit$prior

## Display the correlation estimate of the gaussian copula
res.fit$Rcopula

## Display the first posteriors
head(res.fit$posterior)
</code></pre>


</div>