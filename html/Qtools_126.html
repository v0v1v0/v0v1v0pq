<div class="container">

<table style="width: 100%;"><tr>
<td>sparsity.rqt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sparsity Estimation
</h2>

<h3>Description</h3>

<p>This function estimates the density and sparsity functions of the residuals from a <code>rq</code> or a <code>rqt</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sparsity(object, se = "nid", hs = TRUE)
## S3 method for class 'rq'
sparsity(object, se = "nid", hs = TRUE)
## S3 method for class 'rqs'
sparsity(object, se = "nid", hs = TRUE)
## S3 method for class 'rqt'
sparsity(object, se = "nid", hs = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a <code>rq</code>, <code>rqs</code> or <code>rqt</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>"iid" if errors are assumed independent and identically distributed; "nid" (default) if independent but not identically distributed; "ker" which uses a kernel estimate of the sandwich as proposed by Powell (1991).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hs</code></td>
<td>

<p>logical flag. If <code>TRUE</code> (default) the Hall-Sheather rule is used. Otherwise, the Bofinger's rule is used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is based on the code from <code>quantreg::summary.rq</code> and <code>quantreg::bandwidth.rq</code> to estimate the sparsity function for linear quantile regression models (Koenker and Bassett, 1978) and transformation models of Geraci and Jones (2014).
</p>


<h3>Value</h3>

<p><code>sparsity</code> returns an object of <code>class</code> <code>list</code> that contains three elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>estimate of the density of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity</code></td>
<td>
<p>estimate of the sparsity of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth used for estimation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marco Geraci
</p>


<h3>References</h3>

<p>Geraci M and Jones MC. Improved transformation-based quantile regression. Canadian Journal of Statistics 2015;43(1):118-132.
</p>
<p>Koenker R. quantreg: Quantile Regression. 2016. R package version 5.29.
</p>
<p>Koenker R, Bassett G. Regression quantiles. Econometrica. 1978;46(1):33-50.
</p>
<p>Powell JL. Estimation of monotonic regression models under quantile restrictions. In: Barnett W, Powell J, Tauchen G, editors. Nonparametric and Semiparametric Methods in Econometrics and Statistics: Proceedings of the Fifth International Symposium on Economic Theory and Econometrics. New York, NY: Cambridge University Press 1991. p. 357-84.
</p>


<h3>See Also</h3>

<p><code>rq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

data(trees)

# 'rqt' object

fit.rqt &lt;- tsrq(Volume ~ Height, tsf = "bc", symm = FALSE, data = trees,
	lambda = seq(-10, 10, by = 0.01), tau = 0.5)
sparsity(fit.rqt)

# 'rq' object

fit.rq &lt;- rq(Volume ~ Height, data = trees)
sparsity(fit.rq, se = "iid")
sparsity(fit.rq, se = "nid")
sparsity(fit.rq, se = "ker")

## End(Not run)

</code></pre>


</div>