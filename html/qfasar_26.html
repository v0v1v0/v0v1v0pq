<div class="container">

<table style="width: 100%;"><tr>
<td>sig_rep_zero</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Replace invalid fatty acid signature proportions</h2>

<h3>Description</h3>

<p>The utility function <code>sig_rep_zero</code> replaces fatty acid signature
proportions that are less than or equal to zero or missing with a small
constant and uses the multiplicative method (Martin-Fernandez et al. 2011)
to scale the proportions to sum to 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sig_rep_zero(sig_data, zero_rep = 75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sig_data</code></td>
<td>
<p>A numeric matrix containing signature data as either
proportions or percentages in column-major format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_rep</code></td>
<td>
<p>A constant associated with the method and value to be
used to replace invalid values.  See Details. Default value 75.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements: </p>

<dl>
<dt>sig_adj</dt>
<dd>
<p>The signature data with non-positive or missing proportions
replaced and scaled to sum to 1.0.</p>
</dd>
<dt>rep_val</dt>
<dd>
<p>The value used to replace invalid proporitons.</p>
</dd>
<dt>err_code</dt>
<dd>
<p>An integer error code (0 if no error is detected).</p>
</dd>
<dt>err_message</dt>
<dd>
<p>A string contains a brief summary of the execution.</p>
</dd>
</dl>
<h3>Details</h3>

<p>The function <code>sig_rep_zero</code> is an internal utility function.
</p>
<p>The Kullback-Leibler (Iverson et al. 2004) and Aitchison (Stewart et al.
2014) distance measures are not defined for proportions of zero.
Consequently, if either of these distance measures will be used in an
analysis, the argument <code>zero_rep</code> should be strictly greater than 0.
The chi-square distance measure (Stewart et al. 2014) is defined for
proportions of zero, so if that distance measure will be used in the
analysis, the argument <code>zero_rep</code> may equal zero.  For simulation or
other comparative work involving multiple distance measures, it may be
advisable to use a common value to replace zeros.
</p>
<p>The argument <code>zero_rep</code> must be either:</p>

<ul>
<li>
<p> Greater than or equal to 0 and no greater than 0.01, in which case
the specified value is used to replace invalid proportions.
</p>
</li>
<li>
<p> Between 10 and 100, with an uninformed  default of 75.  In this
case, <code>zero_rep</code> is interpreted as a percentage.  The smallest
non-zero proportion in <code>sig_data</code> is multiplied by the percentage
and divided by 100.  The result is used to replace invalid proportions.
</p>
</li>
</ul>
<p>Although Bromaghin et al. (2016) found that scaling signatures
by varying constants introduces a bias in diet estimation, the slight
distortion of the signatures caused by replacing invalid proportions
with a small constant that varies between signatures is unlikely to
introduce meaningful bias.
</p>


<h3>References</h3>

<p>Bromaghin, J.F., S.M. Budge, and G.W. Thiemann. 2016. Should fatty
acid signature proportions sum to 1 for diet estimation?
<em>Ecological Research</em> 31:597-606.
</p>
<p>Iverson, S.J., C. Field, W.D. Bowen, and W. Blanchard. 2004.
Quantitative fatty acid signature analysis: A new method of
estimating predator diets. <em>Ecological Monographs</em> 74:211-235.
</p>
<p>Martin-Fernandez, J.A., J. Palarea-Albaladejo, and R.A. Olea. 2011.
Dealing with zeros. P. 43-58 in V. Pawlowsky-Glahn and A. Buccianto,
eds. Compositional data analysis: theory and application. John Wiley,
Chichester.
</p>
<p>Stewart, C., and C. Field. 2011. Managing the essential zeros in quantitative
fatty acid signature analysis. <em>Journal of Agricultural, Biological, and
Environmental Statistics</em> 16:45?69.
</p>


</div>