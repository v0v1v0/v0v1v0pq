<div class="container">

<table style="width: 100%;"><tr>
<td>rearrange</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rearrangement</h2>

<h3>Description</h3>

<p> Monotonize a step function by rearrangement </p>


<h3>Usage</h3>

<pre><code class="language-R"> rearrange(f,xmin,xmax) </code></pre>


<h3>Arguments</h3>

 
<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p> object of class stepfun </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>minimum of the support of the rearranged f</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>maximum of the support of the rearranged f</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a stepfunction <code class="reqn">Q(u)</code>, not necessarily monotone, let 
<code class="reqn">F(y) = \int \{ Q(u) \le y \} du</code> denote the associated cdf
obtained by randomly evaluating <code class="reqn">Q</code> at <code class="reqn">U \sim U[0,1]</code>.  The
rearranged version of <code class="reqn">Q</code> is <code class="reqn">\tilde Q (u) = \inf \{
   u: F(y) \ge u \}.  The rearranged function inherits the right
   or left continuity of original stepfunction.</code>
</p>


<h3>Value</h3>

<p> Produces transformed stepfunction that is monotonic increasing.  </p>


<h3>Author(s)</h3>

<p>R. Koenker</p>


<h3>References</h3>

 
<p>Chernozhukov, V., I. Fernandez-Val, and A. Galichon, (2006)  Quantile and Probability
Curves without Crossing, Econometrica, forthcoming.
</p>
<p>Chernozhukov, V., I. Fernandez-Val, and A. Galichon, (2009)  Improving Estimates of
Monotone Functions by Rearrangement, Biometrika, 96, 559â€“575. 
</p>
<p>Hardy, G.H., J.E. Littlewood, and G. Polya (1934)  Inequalities,  Cambridge U. Press.
</p>


<h3>See Also</h3>

 <p><code>rq</code> <code>rearrange</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(engel)
z &lt;- rq(foodexp ~ income, tau = -1,data =engel)
zp &lt;- predict(z,newdata=list(income=quantile(engel$income,.03)),stepfun = TRUE)
plot(zp,do.points = FALSE, xlab = expression(tau),
        ylab = expression(Q ( tau )), main="Engel Food Expenditure Quantiles")
plot(rearrange(zp),do.points = FALSE, add=TRUE,col.h="red",col.v="red")
legend(.6,300,c("Before Rearrangement","After Rearrangement"),lty=1,col=c("black","red"))
</code></pre>


</div>