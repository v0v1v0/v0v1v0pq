<div class="container">

<table style="width: 100%;"><tr>
<td>qic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quality improvement charts</h2>

<h3>Description</h3>

<p>Run and control charts for quality improvement and control
</p>


<h3>Usage</h3>

<pre><code class="language-R">qic(
  y,
  n,
  x,
  data,
  chart = c("run", "i", "mr", "xbar", "s", "t", "p", "c", "u", "g"),
  notes = NULL,
  cl = NULL,
  agg.fun = c("mean", "sum"),
  ylim = NULL,
  target = NULL,
  direction = NULL,
  freeze = NULL,
  breaks = NULL,
  exclude = NULL,
  negy = TRUE,
  dots.only = FALSE,
  multiply = 1,
  prime = FALSE,
  standardised = FALSE,
  x.format = "%Y-%m-%d",
  nint = 5,
  cex = 0.8,
  main,
  xlab = "Subgroup",
  ylab = "Indicator",
  sub = NULL,
  decimals = NULL,
  pre.text = "Before data",
  post.text = "After data",
  llabs = c("LCL", "CL", "UCL", "TRG"),
  runvals = FALSE,
  linevals = TRUE,
  plot.chart = TRUE,
  print.out = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector of counts or measures to plot. Mandatory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numeric vector of sample sizes. Mandatory for P and U charts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Subgrouping vector used for aggregating data and making x-labels.
Mandatory for Xbar and S charts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chart</code></td>
<td>
<p>Type of control chart. Possible types are: </p>
 <ul>
<li>
<p>"run": run chart (default). </p>
</li>
<li>
<p> "i": individuals chart. </p>
</li>
<li>
<p> "mr":
moving range chart. </p>
</li>
<li>
<p> "xbar": sample average chart. </p>
</li>
<li>
<p> "s": sample
standard deviation chart. </p>
</li>
<li>
<p> "t": time between events chart. </p>
</li>
<li>
<p> "p":
proportions chart. </p>
</li>
<li>
<p> "c": counts chart. </p>
</li>
<li>
<p> "u": rates chart. </p>
</li>
<li>
<p>"g": cases between events chart. </p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notes</code></td>
<td>
<p>Character vector of notes to be added to individual. data
points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>Value specifying the center line (if known). Must be of length one
or same as number of subgroups (for variable center line).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agg.fun</code></td>
<td>
<p>String specifying the aggregate function if there is more than
one value per subgroup. Possible values are  'mean' and 'sum'. Only
relevant if you want to aggregate count data with run charts or I charts.
If <code>agg.fun</code> = 'sum', the <code>n</code> argument (if provided) will be
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Range of y axis limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Value specifying a target line to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>Value indication direction of improvement, 0 (down) or 1
(up).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freeze</code></td>
<td>
<p>Number identifying the last data point to include in
calculations of center and limits (ignored if <code>breaks</code> argument is
given).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Numeric vector of break points. Useful for splitting graph in
two or more sections with separate center line and control limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>Numeric vector of data points to exclude from calculations of
center and control lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negy</code></td>
<td>
<p>Logical value, if TRUE, the y axis is allowed to be negative
(only relevant for I and Xbar charts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dots.only</code></td>
<td>
<p>Logical value. If TRUE, data points are not connected by
lines and runs analysis is not performed. Useful for comparison and funnel
plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiply</code></td>
<td>
<p>Integer indicating a number to multiply y axis by, e.g. 100
for percents rather than proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prime</code></td>
<td>
<p>Logical value, if TRUE, control limits incorporate
between-subgroup variation as proposed by Laney (2002). This is recommended
for data involving very large sample sizes. Only relevant for P and U
charts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardised</code></td>
<td>
<p>Logical value, if TRUE, creates a standardised control
chart, where points are plotted in standard deviation units along with a
center line at zero and control limits at 3 and -3. Only relevant for P, U
and Xbar charts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.format</code></td>
<td>
<p>Date format of x axis labels. See ?strftime for date formats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nint</code></td>
<td>
<p>Number indicating (approximately) the desired number of tick
marks on the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Number indicating the amount by which text and symbols should be
magnified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Character string specifying the title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Character string specifying the x axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Character string specifying the y axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>Character string specifying a subtitle to be printed in the lower
left corner of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decimals</code></td>
<td>
<p>Integer indicating the number of decimals shown for center
and limits on the plot. Default behaviour is smart rounding to at least two
significant digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre.text</code></td>
<td>
<p>Character string labelling pre-freeze period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.text</code></td>
<td>
<p>Character string labelling post-freeze period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llabs</code></td>
<td>
<p>Character vector with four elements specifying labels for lower
control limit, centre line, upper control limit and target line
respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runvals</code></td>
<td>
<p>Logical value, if TRUE, prints statistics from runs analysis
on plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linevals</code></td>
<td>
<p>Logical value, if TRUE, prints values for center and control
lines on plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.chart</code></td>
<td>
<p>Logical value, if TRUE, prints plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.out</code></td>
<td>
<p>Logical value, if TRUE, prints return value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to plot function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>chart</code> is not specified, <code>qic()</code> plots a <strong>run
chart</strong>. Non-random variation will be marked by a dashed, yellow center line
(the median) if either the longest run of data points above or below the
median is longer than predicted or if the graph crosses the median fewer
times than predicted (see references for details).
</p>
<p>Only the <code>y</code> argument giving the count or measure of interest is
mandatory for a run chart. If a denominator argument, <code>n</code>, is given,
<code class="reqn">y/n</code> will be plotted. If a subgrouping argument, <code>x</code>, is given,
<code class="reqn">sum(y)/sum(n)</code>, within each subgroup will be plotted. This behaviour
can be modified using the <code>agg.fun</code> argument.
</p>
<p>With <strong>controlcharts</strong>, data aggregation by subgroups is handled
according to chart type. For P, U, and I charts, data are aggregated as
described for the run chart. For the C chart, the sum of counts,
<code>sum(y)</code>, within each subgroups will be plotted.
</p>
<p>For Xbar and S charts, the subgrouping argument, <code>x</code>, is mandatory.
However, the sample size argument, <code>n</code>, is irrelevant and will be
ignored.
</p>
<p>The subgrouping argument, <code>x</code>, is irrelevant for T and G charts, and,
if given, an error will occur if any subgroup has more than one element.
</p>
<p>If more than one <code>note</code> is present within any subgroup, the first
<code>note</code> (alphabetically) is chosen.
</p>
<p>If both <code>prime</code> and <code>standardised</code> are <code>TRUE</code>, points are
plotted in units corresponding to Laney's modified "standard deviation",
which incorporates the variation between subgroups.
</p>


<h3>Value</h3>

<p>A list of of class qic containing values and parameters of the qic
plot.
</p>


<h3>References</h3>

<p>Runs analysis: </p>
 <ul>
<li>
<p> Jacob Anhoej, Anne Vingaard Olesen
(2014). Run Charts Revisited: A Simulation Study of Run Chart Rules for
Detection of Non-Random Variation in Health Care Processes. PLoS ONE 9(11):
e113825. doi: 10.1371/journal.pone.0113825 . </p>
</li>
<li>
<p> Jacob Anhoej (2015).
Diagnostic Value of Run Chart Analysis: Using Likelihood Ratios to Compare
Run Chart Rules on Simulated Data Series. PLoS ONE 10(3): e0121349. doi:
10.1371/journal.pone.0121349 </p>
</li>
<li>
<p> Mark F. Schilling (2012). The Surprising
Predictability of Long Runs. Math. Mag. 85, 141-149. </p>
</li>
<li>
<p> Zhenmin Chen
(2010). A note on the runs test. Model Assisted Statistics and Applications
5, 73-77. </p>
</li>
</ul>
<p> Calculation of control limits: </p>
 <ul>
<li>
<p>   Douglas C.
Montgomery (2009). Introduction to Statistical Process Control, Sixth
Edition, John Wiley &amp; Sons. </p>
</li>
<li>
<p> James C. Benneyan (2001). Number-Between
g-Type Statistical Quality Control Charts for Monitoring Adverse Events.
Health Care Management Science 4, 305-318. </p>
</li>
<li>
<p> Lloyd P. Provost, Sandra
K. Murray (2011). The Health Care Data Guide: Learning from Data for
Improvement. San Francisco: John Wiley &amp; Sons Inc. </p>
</li>
<li>
<p> David B. Laney
(2002). Improved control charts for attributes. Quality Engineering, 14(4),
531-537.</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
# Run chart of 24 samples of a random continuous variable
# with an approximate mean = 12 and standard deviation = 3.
y &lt;- rnorm(24, 12, 3)
qic(y)

# Add subgroup vector (dates) and a target
x &lt;- seq.Date(as.Date('2013-08-04'), by = 'week', length = 24)
qic(y, x = x, target = 16)

# Individuals control chart
qic(y, x = x, chart = 'i')

# Xbar control chart, sample size = 5
y &lt;- rnorm(5 * 24)
x &lt;- rep(x, 5)
qic(y, x = x, chart = 'xbar')

# Create data frame with counts and sample sizes by week
d &lt;- data.frame(week = seq.Date(as.Date('2013-08-04'),
                                by = 'week',
                                length = 36),
                y = c(rbinom(24, 20, 0.5), rbinom(12, 20, 0.8)),
                n = round(rnorm(36, 20, 2)))

# Proportions control chart
qic(y, n, x = week, data = d[1:24,], chart = 'p')

# Introduce change in process performance
qic(y, n, x = week, data = d, chart = 'p')

# Freeze baseline to first 24 samples
qic(y, n, x = week, data = d, chart = 'p', freeze = 24)

# Break control chart before and after change
qic(y, n, x = week, data = d, chart = 'p', breaks = 24)

# Introduce extreme sample value and notes
d$a &lt;- ''
d$a[30] &lt;- 'Extreme value'
d$y[30] &lt;- 1
qic(y, n, x = week, data = d, chart = 'p',
    breaks = 24,
    notes = a)

# Exclude value from calculations
d$a[30] &lt;- 'Value excluded from calculations'
qic(y, n, x = week, data = d, chart = 'p',
    breaks = 24,
    notes = a,
    exclude = 30)
</code></pre>


</div>