<div class="container">

<table style="width: 100%;"><tr>
<td>probs_to_grid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subset genotype probability array to pseudomarkers on a grid</h2>

<h3>Description</h3>

<p>Subset genotype probability array (from <code>calc_genoprob()</code>
to a grid of pseudomarkers along each chromosome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">probs_to_grid(probs, grid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Genotype probabilities as output from
<code>calc_genoprob()</code> with <code>stepwidth="fixed"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>List of logical vectors that indicate which positions
are on the grid and should be retained.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This only works if <code>calc_genoprob()</code> was run
with <code>stepwidth="fixed"</code>, so that the genotype
probabilities were calculated at a grid of
markers/pseudomarkers. When this is the case, we omit all but
the probabilities on this grid. Use <code>calc_grid()</code> to
find the grid positions.
</p>


<h3>Value</h3>

<p>An object of class <code>"calc_genoprob"</code>, like the input, subset to just include
pseudomarkers along a grid. See <code>calc_genoprob()</code>.
</p>


<h3>See Also</h3>

<p><code>calc_grid()</code>, <code>map_to_grid()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">grav2 &lt;- read_cross2(system.file("extdata", "grav2.zip", package="qtl2"))
map_w_pmar &lt;- insert_pseudomarkers(grav2$gmap, step=1)
probs &lt;- calc_genoprob(grav2, map_w_pmar, error_prob=0.002)
sapply(probs, dim)
grid &lt;- calc_grid(grav2$gmap, step=1)
probs_sub &lt;- probs_to_grid(probs, grid)
sapply(probs_sub, dim)
</code></pre>


</div>