<div class="container">

<table style="width: 100%;"><tr>
<td>mqcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Quality Control Charts</h2>

<h3>Description</h3>

<p>Create an object of class 'mqcc' to perform multivariate statistical quality control.</p>


<h3>Usage</h3>

<pre><code class="language-R">mqcc(data, type = c("T2", "T2.single"), center, cov,
     limits = TRUE, pred.limits = FALSE,
     data.name, labels, newdata, newlabels, 
     confidence.level = (1 - 0.0027)^p, rules = shewhart.rules,
     plot = TRUE, ...)

## S3 method for class 'mqcc'
print(x, ...)

## S3 method for class 'mqcc'
summary(object, digits = getOption("digits"), ...)

## S3 method for class 'mqcc'
plot(x, add.stats = TRUE, chart.all = TRUE,
     label.limits = c("LCL", "UCL"), label.pred.limits = c("LPL", "UPL"),
     title, xlab, ylab, ylim, axes.las = 0, 
     digits = getOption("digits"), restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>For subgrouped data, a list with a data frame or a matrix for each variable to monitor. Each row of the data frame or matrix refers to a sample or ”rationale” group. 
For individual observations, where each sample has a single observation, users can provide a list with a data frame or a matrix having a single column, or a data frame or a matrix where each rows refer to samples and columns to variables. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string specifying the type of chart:
</p>

<table>
<tr>
<td style="text-align: left;">
            </td>
<td style="text-align: left;"> Chart description </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"T2"</code> </td>
<td style="text-align: left;"> Hotelling <code class="reqn">T^2</code> chart for subgrouped data </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"T2.single"</code> </td>
<td style="text-align: left;"> Hotelling <code class="reqn">T^2</code> chart for individual observations </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a vector of values to use for center of input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>a matrix of values to use for the covariance matrix of input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>a logical indicating if control limits (Phase I) must be computed (by default using <code>limits.T2</code> or <code>limits.T2.single</code>) and plotted, or a two-values vector specifying control limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.limits</code></td>
<td>
<p>a logical indicating if prediction limits (Phase II) must be computed (by default using <code>limits.T2</code> or <code>limits.T2.single</code>) and plotted, or a two-values vector specifying prediction limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a character vector of labels for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data frame, matrix or vector, as for the <code>data</code> argument, providing further data to plot but not included in the computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newlabels</code></td>
<td>
<p>a character vector of labels for each new group defined in the argument <code>newdata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence.level</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the confidence level of the computed probability limits. 
By default is set at <code class="reqn">(1 - 0.0027)^p</code> where <code class="reqn">p</code> is the number of variables, and <code class="reqn">0.0027</code> is the probability of Type I error for a single Shewhart chart at the usual 3-sigma control level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rules</code></td>
<td>
<p>a function of rules to apply to the chart. By default, the <code>shewhart.rules</code> function is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical. If <code>TRUE</code> a quality chart is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and other information should be printed at the bottom of the chart.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.limits</code></td>
<td>
<p>a character vector specifying the labels for control limits (Phase I).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pred.limits</code></td>
<td>
<p>a character vector specifying the labels for prediction  control limits (Phase II).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes.las</code></td>
<td>
<p>numeric in {0,1,2,3} specifying the style of axis labels. See <code>help(par)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of significant digits to use when <code>add.stats = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class 'mqcc'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class 'mqcc'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class 'mqcc'.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br>
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br>
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br>
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br>
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code>stats.T2</code>, <code>stats.T2.single</code>, <code>limits.T2</code>, <code>limits.T2.single</code>, <code>ellipseChart</code>, <code>qcc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
##  Subgrouped data
##

# Ryan (2000, Table 9.2) data with p = 2 variables, m = 20 samples, n = 4 sample size:
X1 &lt;- matrix(c(72, 56, 55, 44, 97, 83, 47, 88, 57, 26, 46, 
49, 71, 71, 67, 55, 49, 72, 61, 35, 84, 87, 73, 80, 26, 89, 66, 
50, 47, 39, 27, 62, 63, 58, 69, 63, 51, 80, 74, 38, 79, 33, 22, 
54, 48, 91, 53, 84, 41, 52, 63, 78, 82, 69, 70, 72, 55, 61, 62, 
41, 49, 42, 60, 74, 58, 62, 58, 69, 46, 48, 34, 87, 55, 70, 94, 
49, 76, 59, 57, 46), ncol = 4)
X2 &lt;- matrix(c(23, 14, 13, 9, 36, 30, 12, 31, 14, 7, 10, 
11, 22, 21, 18, 15, 13, 22, 19, 10, 30, 31, 22, 28, 10, 35, 18, 
11, 10, 11, 8, 20, 16, 19, 19, 16, 14, 28, 20, 11, 28, 8, 6, 
15, 14, 36, 14, 30, 8, 35, 19, 27, 31, 17, 18, 20, 16, 18, 16, 
13, 10, 9, 16, 25, 15, 18, 16, 19, 10, 30, 9, 31, 15, 20, 35, 
12, 26, 17, 14, 16), ncol = 4)
X &lt;- list(X1 = X1, X2 = X2)

q &lt;- mqcc(X, type = "T2")
summary(q)
ellipseChart(q)
ellipseChart(q, show.id = TRUE)

q &lt;- mqcc(X, type = "T2", pred.limits = TRUE)

# Ryan (2000) discussed Xbar-charts for single variables computed adjusting the 
# confidence level of the T^2 chart:
q1 &lt;- qcc(X1, type = "xbar", confidence.level = q$confidence.level^(1/2))
summary(q1)
q2 &lt;- qcc(X2, type = "xbar", confidence.level = q$confidence.level^(1/2))
summary(q2)


require(MASS)
# generate new "in control" data
Xnew &lt;- list(X1 = matrix(NA, 10, 4), X2 =  matrix(NA, 10, 4))
for(i in 1:4)
   { x &lt;- mvrnorm(10, mu = q$center, Sigma = q$cov)
     Xnew$X1[,i] &lt;- x[,1]
     Xnew$X2[,i] &lt;- x[,2] 
   }
qq &lt;- mqcc(X, type = "T2", newdata = Xnew, pred.limits = TRUE)
summary(qq)

# generate new "out of control" data
Xnew &lt;- list(X1 = matrix(NA, 10, 4), X2 =  matrix(NA, 10, 4))
for(i in 1:4)
   { x &lt;- mvrnorm(10, mu = 1.2*q$center, Sigma = q$cov)
     Xnew$X1[,i] &lt;- x[,1]
     Xnew$X2[,i] &lt;- x[,2] 
   }
qq &lt;- mqcc(X, type = "T2", newdata = Xnew, pred.limits = TRUE)
summary(qq)

##
## Individual observations data
##

data(boiler)

q &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999)
summary(q)

# generate new "in control" data
boilerNew &lt;- mvrnorm(10, mu = q$center, Sigma = q$cov)
qq &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999, 
           newdata = boilerNew, pred.limits = TRUE)
summary(qq)

# generate new "out of control" data
boilerNew = mvrnorm(10, mu = 1.01*q$center, Sigma = q$cov)
qq &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999, 
           newdata = boilerNew, pred.limits = TRUE)
summary(qq)

# provides "robust" estimates of means and covariance matrix
library(MASS)
rob &lt;- cov.rob(boiler)
qrob &lt;- mqcc(boiler, type = "T2.single", center = rob$center, cov = rob$cov)
summary(qrob)

</code></pre>


</div>