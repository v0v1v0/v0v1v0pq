<div class="container">

<table style="width: 100%;"><tr>
<td>flFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a fluorescence curve analysis on all samples in the provided dataset.</h2>

<h3>Description</h3>

<p><code>flFit</code> performs all computational fluorescence fitting operations based on the user input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flFit(
  fl_data,
  time = NULL,
  growth = NULL,
  control = fl.control(),
  parallelize = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fl_data</code></td>
<td>
<p>Either... </p>
 <ol>
<li>
<p> a <code>grodata</code> object created with <code>read_data</code> or <code>parse_data</code>,
</p>
</li>
<li>
<p> a list containing a <code>'time'</code> matrix (for x_type == "time") or <code>'growth'</code> dataframe (for x_type == "growth") and a <code>'fluorescence'</code> dataframes,
or </p>
</li>
<li>
<p> a dataframe containing (normalized) fluorescence values (if a <code>time</code> matrix or <code>growth</code> dataframe is provided as separate argument).</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>(optional) A matrix containing time values for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>growth</code></td>
<td>
<p>(optional) A dataframe containing growth values for each sample and sample identifiers in the first three columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A <code>fl.control</code> object created with <code>fl.control</code>, defining relevant fitting options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallelize</code></td>
<td>
<p>Run linear fits and bootstrapping operations in parallel using all but one available processor cores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the shiny app.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Common response parameters used in dose-response analysis:<br><br><b>Linear fit:</b><br>- max_slope.linfit: Fluorescence increase rate<br>- lambda.linfit: Lag time<br>- dY.linfit: Maximum Fluorescence - Minimum Fluorescence<br>- A.linfit: Maximum fluorescence<br><br><b>Spline fit:</b><br>- max_slope.spline: Fluorescence increase rate<br>- lambda.spline: Lag time<br>- dY.spline: Maximum Fluorescence - Minimum Fluorescence<br>- A.spline: Maximum fluorescence<br>- integral.spline: Integral<br><br><b>Parametric fit:</b><br>- max_slope.model: Fluorescence increase rate<br>- lambda.model: Lag time<br>- dY.model: Maximum Fluorescence - Minimum Fluorescence<br>- A.model: Maximum fluorescence<br>- integral.model: Integral'
</p>


<h3>Value</h3>

<p>An <code>flFit</code> object that contains all fluorescence fitting results, compatible with
various plotting functions of the QurvE package.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>raw.x</code></td>
<td>
<p>Raw x matrix passed to the function as <code>time</code> (for x_type = 'time') or <code>growth</code> (for x_type = 'growth').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.fl</code></td>
<td>
<p>Raw growth dataframe passed to the function as <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flTable</code></td>
<td>
<p>Table with fluorescence parameters and related statistics for each fluorescence curve evaluation performed by the function. This table, which is also returned by the generic <code>summary.flFit</code> method applied to a <code>flFit</code> object, is used as an input for <code>fl.drFit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flFittedLinear</code></td>
<td>
<p>List of all <code>flFitLinear</code> objects, generated by the call of <code>flFitLinear</code>. Note: access to each object in the list via double brace: flFittedLinear[[#n]].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flFittedSplines</code></td>
<td>
<p>List of all <code>flFitSpline</code> objects, generated by the call of <code>flFitSpline</code>. Note: access to each object via double brace: flFittedSplines[[#n]].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flBootSplines</code></td>
<td>
<p>List of all <code>flBootSpline</code> objects, generated by the call of <code>flBootSpline</code>. Note: access to each object via double brace: flFittedSplines[[#n]].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Object of class <code>fl.control</code> containing list of options passed to the function as <code>control</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Other workflows: 
<code>growth.gcFit()</code>,
<code>growth.workflow()</code>
</p>
<p>Other fluorescence fitting functions: 
<code>flBootSpline()</code>,
<code>flFitSpline()</code>
</p>
<p>Other dose-response analysis functions: 
<code>growth.drBootSpline()</code>,
<code>growth.drFitSpline()</code>,
<code>growth.gcFit()</code>,
<code>growth.workflow()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load example dataset
input &lt;- read_data(data.growth = system.file("lac_promoters_growth.txt", package = "QurvE"),
                   data.fl = system.file("lac_promoters_fluorescence.txt", package = "QurvE"),
                   csvsep = "\t",
                   csvsep.fl = "\t" )

# Define fit controls
control &lt;- fl.control(fit.opt = "s",
             x_type = "time", norm_fl = TRUE,
             dr.parameter = "max_slope.spline",
             dr.method = "model",
             suppress.messages = TRUE)

# Run curve fitting workflow
res &lt;- flFit(fl_data = input$norm.fluorescence,
             time = input$time,
             control = control,
             parallelize = FALSE)

summary(res)

</code></pre>


</div>