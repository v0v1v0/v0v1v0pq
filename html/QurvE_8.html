<div class="container">

<table style="width: 100%;"><tr>
<td>fl.drFitModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a biosensor model fit on response vs. concentration data of a single sample.</h2>

<h3>Description</h3>

<p><code>fl.drFitModel</code> fits the biosensor model proposed by Meyer et al. (2019) to the provided response (e.g., <code>max_slope.spline</code> vs. concentration data to determine the leakiness, sensitivity, induction fold-change, and cooperativity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fl.drFitModel(conc, test, drID = "undefined", control = fl.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Vector of concentration values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Vector of response parameter values of the same length as <code>conc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drID</code></td>
<td>
<p>(Character) The name of the analyzed condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A <code>fl.control</code> object created with <code>fl.control</code>, defining relevant fitting options.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>drFitFLModel</code> object.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>raw.conc</code></td>
<td>
<p>Raw data provided to the function as <code>conc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.test</code></td>
<td>
<p>Raw data for the response parameter provided to the function as <code>test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drID</code></td>
<td>
<p>(Character) Identifies the tested condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.conc</code></td>
<td>
<p>Fitted concentration values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.test</code></td>
<td>
<p>Fitted response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>nls</code> object generated by the <code>nlsLM</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>List of parameters estimated from dose response curve fit.</p>
</td>
</tr>
</table>
<ul>
<li> <p><code>yEC50</code>: Response value related to EC50.
</p>
</li>
<li> <p><code>y.min</code>: Minimum fluorescence ('leakiness', if lowest concentration is 0).
</p>
</li>
<li> <p><code>y.max</code>: Maximum fluorescence.
</p>
</li>
<li> <p><code>fc</code>: Fold change (<code>y.max</code> divided by <code>y.min</code>).
</p>
</li>
<li> <p><code>K</code>: Concentration at half-maximal response ('sensitivity').
</p>
</li>
<li> <p><code>n</code>: Cooperativity.
</p>
</li>
<li> <p><code>yEC50.orig</code>: Response value for EC50 in original scale, if a transformation was applied.
</p>
</li>
<li> <p><code>K.orig</code>: K in original scale, if a transformation was applied.
</p>
</li>
<li> <p><code>test.nm</code>: Test identifier extracted from <code>test</code>.
</p>
</li>
</ul>
<table>
<tr style="vertical-align: top;">
<td><code>fitFlag</code></td>
<td>
<p>(Logical) Indicates whether a spline could fitted successfully to data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reliable</code></td>
<td>
<p>(Logical) Indicates whether the performed fit is reliable (to be set manually).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Object of class <code>fl.control</code> created with the call of <code>fl.control</code>.</p>
</td>
</tr>
</table>
<p>Use <code>plot.drFitModel</code> to visualize the model fit.
</p>


<h3>References</h3>

<p>Meyer, A.J., Segall-Shapiro, T.H., Glassey, E. et al. <em>Escherichia coli “Marionette” strains with 12 highly optimized small-molecule sensors.</em> Nat Chem Biol 15, 196–204 (2019). DOI: 10.1038/s41589-018-0168-3
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create concentration values via a serial dilution
conc &lt;- c(0, rev(unlist(lapply(1:18, function(x) 10*(2/3)^x))),10)

# Simulate response values via biosensor equation
response &lt;- biosensor.eq(conc, y.min = 110, y.max = 6000, K = 0.5, n = 2) +
            0.01*6000*rnorm(10)

# Perform fit
TestRun &lt;- fl.drFitModel(conc, response, drID = 'test', control = fl.control())

print(summary(TestRun))
plot(TestRun)
</code></pre>


</div>