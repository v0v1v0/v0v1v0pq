<div class="container">

<table style="width: 100%;"><tr>
<td>qMRI-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Methods for Quantitative Magnetic Resonance Imaging ('qMRI')
</h2>

<h3>Description</h3>

<p>Implementation of methods for estimation of quantitative maps
    from Multi-Parameter Mapping (MPM) acquisitions (Weiskopf et al. (2013)
    &lt;doi:10.3389/fnins.2013.00095&gt;) and analysis of Inversion Recovery MRI data.
    Usage of the package is described in
    Polzehl and Tabelow (2023),
    "Magnetic Resonance Brain Imaging", 2nd Edition, Chapter 6 and 7, Springer, Use R! Series.
    &lt;doi:10.1007/978-3-031-38949-8&gt;.
    J. Polzehl and K. Tabelow (2023), "Magnetic Resonance Brain Imaging - Modeling and Data Analysis Using R: Code and Data."
    &lt;doi:10.20347/WIAS.DATA.6&gt; provides extensive example code and data.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> qMRI</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Methods for Quantitative Magnetic Resonance Imaging ('qMRI')</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2.7.6</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-05-17</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(person("Joerg", "Polzehl", role = c("aut"),
                    email = "joerg.polzehl@wias-berlin.de"),
             person("Karsten", "Tabelow", role = c("aut", "cre"),
                    email = "karsten.tabelow@wias-berlin.de"),
             person("WIAS Berlin", role = c("cph", "fnd")))</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Karsten Tabelow &lt;karsten.tabelow@wias-berlin.de&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.5), awsMethods (&gt;= 1.0), methods, parallel</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> oro.nifti (&gt;= 0.9), stringr, aws (&gt;= 2.4), adimpro (&gt;= 0.9)</td>
</tr>
<tr>
<td style="text-align: left;">
LazyData: </td>
<td style="text-align: left;"> TRUE</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Implementation of methods for estimation of quantitative maps
    from Multi-Parameter Mapping (MPM) acquisitions (Weiskopf et al. (2013)
    &lt;doi:10.3389/fnins.2013.00095&gt;) and analysis of Inversion Recovery MRI data.
    Usage of the package is described in
    Polzehl and Tabelow (2023),
    "Magnetic Resonance Brain Imaging", 2nd Edition, Chapter 6 and 7, Springer, Use R! Series.
    &lt;doi:10.1007/978-3-031-38949-8&gt;.
    J. Polzehl and K. Tabelow (2023), "Magnetic Resonance Brain Imaging - Modeling and Data Analysis Using R: Code and Data."
    &lt;doi:10.20347/WIAS.DATA.6&gt; provides extensive example code and data.</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
<td style="text-align: left;">
Copyright: </td>
<td style="text-align: left;"> This package is Copyright (C) 2015-2024 Weierstrass
Institute for Applied Analysis and Stochastics.</td>
</tr>
<tr>
<td style="text-align: left;">
URL: </td>
<td style="text-align: left;"> https://www.wias-berlin.de/research/ats/imaging/</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> covr,
testthat,
knitr,
rmarkdown</td>
</tr>
<tr>
<td style="text-align: left;">
VignetteBuilder: </td>
<td style="text-align: left;"> knitr</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 6.1.1</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Joerg Polzehl [aut],
  Karsten Tabelow [aut, cre],
  WIAS Berlin [cph, fnd]</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
MREdisplacement         Calculate the motion induced signal phase for
                        IR-MRE in biphasic material
awssigmc                Estimate noise variance for multicoil MR
                        systems
calculateQI             Obtain quantitative maps from estimated
                        ESTATICS parameters.
colMT                   MT map color scheme
estimateESTATICS        Estimate parameters in the ESTATICS model.
estimateIR              Estimate IRMRI parameters
estimateIRfluid         Estimate parameters in Inversion Recovery MRI
                        experiments model for CSF voxel
estimateIRsolid         Estimate parameters in Inversion Recovery MRI
                        experiments mixture model for non-fluid voxel
estimateIRsolidfixed    Estimate mixture parameter in Inversion
                        Recovery MRI experiments mixture model for
                        non-fluid voxel
extract.ANY-method      Methods to extract information from objects of
                        class '"MPMData"', '"ESTATICSModel"',
                        '"sESTATICSModel"', '"qMaps"', '"IRdata"',
                        '"IRfluid"' and '"IRmixed"'.
generateIRData          generate IR MRI example data
qMRI-package            Methods for Quantitative Magnetic Resonance
                        Imaging ('qMRI')
readIRData              Prepare IRMRI dataset
readMPMData             Read experimental Multi-Parameter Mapping (MPM)
                        data.
smoothESTATICS          Adaptive smoothing of ESTATICS parameters and
                        MPM data
smoothIRSolid           Smooth object generated by function
                        'estimateIRsolid'
writeESTATICS           Write maps of ESTATICS parameters in
                        standardized form as NIfTI files.
writeQI                 Write estimated maps in standardized form as
                        NIfTI files.
</pre>


<h3>Author(s)</h3>

<p>Karsten Tabelow <a href="mailto:tabelow@wias-berlin.de">tabelow@wias-berlin.de</a><br>
J\"org Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a>
</p>
<p>Maintainer: Karsten Tabelow &lt;karsten.tabelow@wias-berlin.de&gt;
</p>


<h3>References</h3>

<p>Weiskopf, N.; Suckling, J.; Williams, G.; Correia, M. M.; Inkster, B.; Tait, R.;
Ooi, C.; Bullmore, E. T. &amp; Lutti, A. Quantitative multi-parameter mapping of
R1, PD(*), MT, and R2(*) at 3T: a multi-center validation. Front Neurosci,
Wellcome Trust Centre for Neuroimaging, UCL Institute of Neurology, University College
London, UK., 2013, 7, 95
</p>
<p>J. Polzehl and K. Tabelow (2023), Magnetic Resonance Brain Imaging:
Modeling and Data Analysis Using R, 2nd Edition, Chapter 6 and 7, Springer, Use R! Series.
&lt;doi:10.1007/978-3-031-38949-8&gt;.
</p>
<p>J. Polzehl and K. Tabelow (2023), Magnetic Resonance Brain Imaging - 
Modeling and Data Analysis Using R: Code and Data.
&lt;doi:10.20347/WIAS.DATA.6&gt;.
</p>


<h3>See Also</h3>

<p><code>aws</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
dataDir &lt;- system.file("extdata",package="qMRI")
#
#  set file names for T1w, MTw and PDw images
#
t1Names &lt;- paste0("t1w_",1:8,".nii.gz")
mtNames &lt;- paste0("mtw_",1:6,".nii.gz")
pdNames &lt;- paste0("pdw_",1:8,".nii.gz")
t1Files &lt;- file.path(dataDir, t1Names)
mtFiles &lt;- file.path(dataDir, mtNames)
pdFiles &lt;- file.path(dataDir, pdNames)
#
#  file names of mask and B1 field map
#
B1File &lt;- file.path(dataDir, "B1map.nii.gz")
maskFile &lt;- file.path(dataDir, "mask.nii.gz")
#
#  Acquisition parameters (TE, TR, Flip Angle) for T1w, MTw and PDw images
#
TE &lt;- c(2.3, 4.6, 6.9, 9.2, 11.5, 13.8, 16.1, 18.4,
        2.3, 4.6, 6.9, 9.2, 11.5, 13.8,
        2.3, 4.6, 6.9, 9.2, 11.5, 13.8, 16.1, 18.4)
TR &lt;- rep(25, 22)
FA &lt;- c(rep(21, 8), rep(6, 6), rep(6, 8))
#
#   read MPM example data
#
library(qMRI)
mpm &lt;- readMPMData(t1Files, pdFiles, mtFiles,
                   maskFile, TR = TR, TE = TE,
                   FA = FA, verbose = FALSE)
#
#  Estimate Parameters in the ESTATICS model
#
modelMPM &lt;- estimateESTATICS(mpm, method = "NLR")
#
#  smooth maps of ESTATICS Parameters
#
setCores(2)
modelMPMsp1 &lt;- smoothESTATICS(modelMPM,
                              kstar = 16,
                              alpha = 0.004,
                              patchsize=1,
                              verbose = TRUE)
#
#  resulting ESTATICS parameter maps for central coronal slice
#
if(require(adimpro)){
rimage.options(zquantiles=c(.01,.99), ylab="z")
oldpar &lt;- par(mfrow=c(2,4),mar=c(3,3,3,1),mgp=c(2,1,0))
on.exit(par(oldpar))
pnames &lt;- c("T1","MT","PD","R2star")
modelCoeff &lt;- extract(modelMPM,"modelCoeff")
for(i in 1:4){
   rimage(modelCoeff[i,,11,])
   title(pnames[i])
   }
   modelCoeff &lt;- extract(modelMPMsp1,"modelCoeff")
for(i in 1:4){
   rimage(modelCoeff[i,,11,])
   title(paste("smoothed",pnames[i]))
   }
}
#
#  Compute quantitative maps (R1, R2star, PD, MT)
#
qMRIMaps &lt;- calculateQI(modelMPM,
                        b1File = B1File,
                        TR2 = 3.4)
qMRISmoothedp1Maps &lt;- calculateQI(modelMPMsp1,
                                    b1File = B1File,
                                    TR2 = 3.4)
#
#  resulting quantitative maps for central coronal slice
#
if(require(adimpro)){
rimage.options(zquantiles=c(.01,.99), ylab="z")
par(mfrow=c(2,4),mar=c(3,3,3,1),mgp=c(2,1,0))
nmaps &lt;- c("R1","R2star","PD","MT")
qmap &lt;- extract(qMRIMaps,nmaps)
for (i in 1:4) rimage(qmap[[i]][,11,],main=nmaps[i])
qmap &lt;- extract(qMRISmoothedp1Maps,nmaps)
for (i in 1:4) rimage(qmap[[i]][,11,],main=paste("Smoothed",nmaps[i]))
}
par(oldpar)

</code></pre>


</div>