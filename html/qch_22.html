<div class="container">

<table style="width: 100%;"><tr>
<td>qch.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform composite hypothesis testing.</h2>

<h3>Description</h3>

<p>Perform any composite hypothesis test by specifying
the configurations '<code>Hconfig.H1</code>' corresponding to the composite alternative hypothesis
among all configurations '<code>Hconfig</code>'.
</p>
<p>By default, the function performs the composite hypothesis test of being associated with "at least <code class="reqn">q</code>" simple tests, for <code class="reqn">q=1,..Q</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qch.test(res.qch.fit, Hconfig, Hconfig.H1 = NULL, Alpha = 0.05, threads_nb = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res.qch.fit</code></td>
<td>
<p>The result provided by the <code>qch.fit()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hconfig</code></td>
<td>
<p>A list of all possible combination of <code class="reqn">H_0</code> and <code class="reqn">H_1</code> hypotheses generated by the <code>GetHconfig()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hconfig.H1</code></td>
<td>
<p>An integer vector (or a list of such vector) of the <code>Hconfig</code> index corresponding to the composite alternative hypothesis configuration(s).
Can be generated by the <code>GetH1AtLeast()</code> or <code>GetH1Equal()</code> functions.
If <code>NULL</code>, the composite hyporhesis tests of being associated with "at least <code class="reqn">q</code>" simple tests, for q=1,..Q are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>the nominal Type I error rate for FDR control. Default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads_nb</code></td>
<td>
<p>The number of threads to use. The number of thread will set to the number of core available by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>Rejection</code> </td>
<td style="text-align: left;"> a matrix providing for each item the result of the composite hypothesis test,
after adaptive Benjamin-HÃ¶chberg multiple testing correction.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lFDR</code> </td>
<td style="text-align: left;"> a matrix providing for each item its local FDR estimate.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Pvalues</code> </td>
<td style="text-align: left;"> a matrix providing for each item its p-value of the composite hypothesis test.
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>qch.fit()</code>, <code>GetH1AtLeast()</code>,<code>GetH1Equal()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PvalSets_cor)
PvalMat &lt;- as.matrix(PvalSets_cor[,-3])
Truth &lt;- PvalSets[,3]

## Build the Hconfig objects
Q &lt;- 2
Hconfig &lt;- GetHconfig(Q)

## Infer the posteriors
res.fit &lt;- qch.fit(pValMat = PvalMat, Hconfig = Hconfig, copula="gaussian")

## Run the test procedure with FDR control
H1config &lt;- GetH1AtLeast(Hconfig,2)
res.test &lt;- qch.test(res.qch.fit = res.fit,Hconfig = Hconfig, Hconfig.H1 = H1config)
table(res.test$Rejection$AtLeast_2,Truth==4)


</code></pre>


</div>