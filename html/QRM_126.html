<div class="container">

<table style="width: 100%;"><tr>
<td>CopulaAC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Archimedean Copulae</h2>

<h3>Description</h3>

<p>Functions for ealuating densities of Archimedean copulae, generating
random variates and fitting data to AC
</p>


<h3>Usage</h3>

<pre><code class="language-R">dcopula.AC(u, theta, name = c("clayton", "gumbel"), log = TRUE)
dcopula.clayton(u, theta, log = FALSE)
dcopula.gumbel(u, theta, log = FALSE)
rAC(name = c("clayton", "gumbel", "frank", "BB9", "GIG"), n, d, theta)
rACp(name = c("clayton", "gumbel", "frank", "BB9", "GIG"), n, d, theta, A)
rcopula.gumbel(n, theta, d)
rcopula.clayton(n, theta, d)
rcopula.frank(n, theta, d)
rstable(n, alpha, beta = 1)
rFrankMix(n, theta)
rBB9Mix(n, theta)
rcopula.Gumbel2Gp(n = 1000, gpsizes = c(2, 2), theta = c(2, 3, 5))
rcopula.GumbelNested(n, theta)
fit.AC(Udata, name = c("clayton", "gumbel"), initial = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p><code>matrix</code>, dimension <code class="reqn">d \times p</code> containing asymmetry
parameters. Rowsums must be equal to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>numeric</code>, parameter <code class="reqn">0 &lt; \alpha \le 2</code>, but <code class="reqn">\alpha
      \ne 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p><code>numeric</code>, parameter <code class="reqn">-1 \le \beta \le 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p><code>integer</code>, dimension of copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpsizes</code></td>
<td>
<p><code>vector</code>, length of two, containing the group
sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p><code>numeric</code>, initial value used by <code>fit.AC()</code> in
the call to <code>nlminb()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p><code>logical</code>, whether log density values should be returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p><code>integer</code>, count of random variates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p><code>character</code>, name of copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p><code>vector</code>, copula parameter(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code>matrix</code>, dimension <code class="reqn">n \times d</code>, where d is the
dimension of the copula and n is the number of vector values at which
to evaluate density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Udata</code></td>
<td>
<p><code>matrix</code>, pseudo-uniform observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ellipsis, arguments are passed down to <code>nlminb()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>dcopula.AC()</code> is a generic function, designed such
that additional copulae, or expressions for densities of
higher-dimensional copulae may be added. Clayton copula works in any
dimension at present but Gumbel is only implemented for <code class="reqn">d = 2</code>. To extend, one must calculate the d-th derivative of the generator
inverse and take the logarithm of absolute value; this is the term
called <code>loggfunc</code>. In addition, for other copulae, one needs the
generator <code class="reqn">\phi</code> and the log of the negative value of its
first derivative <code>lnegphidash</code>.<br> 
The random variates from <code>rAC()</code> with arbitrary dimension are
generated by using the mixture construction of Marshall and Olkin. It
may be used in place of the other functions <code>rcopula.clayton()</code>,
<code>rcopula.gumbel()</code>, and <code>rcopula.frank()</code>. In addition, it
allows simulation of BB9 and GIG copulas which don't have individual
simulation routines.<br>
For the Clayton and Gumbel copulae, see page 192 and 222â€“224 in
QRM. The random variates for the BB9 and Frank copula are obtained from
a mixing distribution using a Laplace transform method (see page 224 of
QRM). The function <code>rcopula.Gumbel2Gp()</code> generates sample from a
Gumbel copula with two-group structure constructed using three Gumbel
generators (see pages 222-224 and 227 of QRM). The function
<code>rcopula.gumbelNested()</code> generates sample from a d-dimensional
Gumbel copula with nested structure constructed using
<code class="reqn">(d-1)</code> Gumbel generators.<br> 
For the random variates of the Stable distribution, a default value
<code class="reqn">\beta = 1</code> is used; combined with a value for
<code class="reqn">\alpha &lt; 1</code> yields a positive stable distribution,
which is required for Gumbel copula generation; the case <code class="reqn">\alpha =
 1</code> has not been implemented.   
</p>


<h3>Value</h3>

<p>vector or matrix in case of the density and random-generator related
functions and a list object for the fitting function.
</p>


<h3>See Also</h3>

<p><code>nlminb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Gumbel
r1 &lt;- rAC("gumbel", n = 50, d = 7, theta = 3)
head(r1)
## Weighted Gumbel
alpha &lt;- c(0.95,0.7)
wtmatrix &lt;- cbind(alpha, 1 - alpha)
r2 &lt;- rACp(name = "gumbel", n = 1000, d = 2, theta = c(4, 1),
           A = wtmatrix)
head(r2)
## Gumbel with two-group structure
r3 &lt;- rcopula.Gumbel2Gp(n = 3000, gpsizes = c(3, 4),
                        theta = c(2, 3, 5)) 
pairs(r3)
## Nested Gumbel
r4 &lt;- rcopula.GumbelNested(n=3000,theta=1:6) 
pairs(r4) 
## Frank
r5 &lt;- rcopula.frank(1000, 2, 4) 
pairs(r5)
## Fitting of Gumbel and Clayton
data(smi)
data(ftse100)
s1 &lt;- window(ftse100, "1990-11-09", "2004-03-25")
s1a &lt;- alignDailySeries(s1)
s2a &lt;- alignDailySeries(smi)
idx &lt;- merge(s1a, s2a)
r &lt;-returns(idx)
rp &lt;- series(window(r, "1994-01-01", "2003-12-31"))
rp &lt;- rp[(rp[, 1] != 0) &amp; (rp[, 2] !=0), ]
Udata &lt;- apply(rp, 2, edf, adjust = 1)
mod.gumbel &lt;- fit.AC(Udata, "gumbel")
mod.clayton &lt;- fit.AC(Udata, "clayton")
mod.clayton
</code></pre>


</div>