<div class="container">

<table style="width: 100%;"><tr>
<td>MIM.search2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>QTL search by MIM with Seletive Genotyping</h2>

<h3>Description</h3>

<p>Expectation-maximization algorithm for QTL multiple interval mapping to
find one more QTL in the presence of some known QTLs. It can handle
genotype data which is selective genotyping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MIM.search2(
  QTL,
  marker,
  geno,
  y,
  yu = NULL,
  sele.g = "n",
  tL = NULL,
  tR = NULL,
  method = "EM",
  type = "RI",
  D.matrix = NULL,
  ng = 2,
  cM = TRUE,
  speed = 1,
  QTLdist = 15,
  link = TRUE,
  crit = 10^-3,
  console = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>QTL</code></td>
<td>
<p>matrix. A q*2 matrix contains the QTL information, where the
row dimension 'q' represents the number of QTLs in the chromosomes. The
first column labels the chromosomes where the QTLs are located, and the
second column labels the positions of QTLs (in morgan (M) or centimorgan
(cM)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>matrix. A k*2 matrix contains the marker information,
where the row dimension 'k' represents the number of markers in the
chromosomes. The first column labels the chromosomes where the markers
are located, and the second column labels the positions of markers (in
morgan (M) or centimorgan (cM)). It's important to note that chromosomes
and positions must be sorted in order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno</code></td>
<td>
<p>matrix. A n*k matrix contains the genotypes of k markers
for n individuals. The marker genotypes of P1 homozygote (MM),
heterozygote (Mm), and P2 homozygote (mm) are coded as 2, 1, and 0,
respectively, with NA indicating missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector. A vector that contains the phenotype values of
individuals with genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yu</code></td>
<td>
<p>vector. A vector that contains the phenotype values of
individuals without genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sele.g</code></td>
<td>
<p>character. Determines the type of data being analyzed:
If sele.g="n", it considers the data as complete genotyping data. If
sele.g="f", it treats the data as selective genotyping data and utilizes
the proposed corrected frequency model (Lee 2014) for analysis; If
sele.g="t", it considers the data as selective genotyping data and uses
the truncated model (Lee 2014) for analysis; If sele.g="p", it treats
the data as selective genotyping data and uses the population
frequency-based model (Lee 2014) for analysis. Note that the 'yu'
argument must be provided when sele.g="f" or "p".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tL</code></td>
<td>
<p>numeric. The lower truncation point of phenotype value when
sele.g="t". When sele.g="t" and tL=NULL, the 'yu' argument must be
provided. In this case, the function will consider the minimum of 'yu'
as the lower truncation point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tR</code></td>
<td>
<p>numeric. The upper truncation point of phenotype value when
sele.g="t". When sele.g="t" and tR=NULL, the 'yu' argument must be
provided. In this case, the function will consider the maximum of 'yu'
as the upper truncation point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character. When method="EM", it indicates that the interval
mapping method by Lander and Botstein (1989) is used in the analysis.
Conversely, when method="REG", it indicates that the approximate regression
interval mapping method by Haley and Knott (1992) is used in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character. The population type of the dataset. Includes
backcross (type="BC"), advanced intercross population (type="AI"), and
recombinant inbred population (type="RI"). The default value is "RI".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D.matrix</code></td>
<td>
<p>matrix. The design matrix of QTL effects is a g*p matrix,
where g is the number of possible QTL genotypes, and p is the number of
effects considered in the MIM model. It's important to note that the QTL
number of the design matrix must be the original QTL number plus one. The
design matrix can be easily generated by the function D.make(). If set to
NULL, it will automatically generate a design matrix with all additive and
dominant effects and without any epistasis effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng</code></td>
<td>
<p>integer. The generation number of the population type. For
instance, in a BC1 population where type="BC", ng=1; in an AI F3
population where type="AI", ng=3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cM</code></td>
<td>
<p>logical. Specify the unit of marker position. If cM=TRUE, it
denotes centimorgan; if cM=FALSE, it denotes morgan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speed</code></td>
<td>
<p>numeric. The walking speed of the QTL search (in cM).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTLdist</code></td>
<td>
<p>numeric. The minimum distance (in cM) among different
linked significant QTL. Positions near the known QTLs within this distance
will not be considered as candidate positions in the search process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>logical. When set to False, positions on the same chromosomes
as the known QTLs will not be searched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>numeric. The convergence criterion of EM algorithm.
The E and M steps will iterate until a convergence criterion is met.
It must be a value between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>console</code></td>
<td>
<p>logical. Determines whether the process of the algorithm
will be displayed in the R console or not.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>The estimated effects, log-likelihood value, and LRT
statistics of all searched positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL.best</code></td>
<td>
<p>The positions of the best QTL combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.best</code></td>
<td>
<p>The estimated effects and LRT statistics of the best
QTL combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model of selective genotyping data in this analyze.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>KAO, C.-H. and Z.-B. ZENG 1997 General formulas for obtaining the maximum
likelihood estimates and the asymptotic variance-covariance matrix in QTL
mapping when using the EM algorithm. Biometrics 53, 653-665. &lt;doi: 10.2307/2533965.&gt;
</p>
<p>KAO, C.-H., Z.-B. ZENG and R. D. TEASDALE 1999 Multiple interval mapping
for Quantitative Trait Loci. Genetics 152: 1203-1216. &lt;doi: 10.1093/genetics/152.3.1203&gt;
</p>
<p>H.-I LEE, H.-A. HO and C.-H. KAO 2014 A new simple method for improving
QTL mapping under selective genotyping. Genetics 198: 1685-1698. &lt;doi: 10.1534/genetics.114.168385.&gt;
</p>


<h3>See Also</h3>

<p><code>EM.MIM2</code>
<code>MIM.search</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load the example data
load(system.file("extdata", "exampledata.RDATA", package = "QTLEMM"))

# make the seletive genotyping data
ys &lt;- y[y &gt; quantile(y)[4] | y &lt; quantile(y)[2]]
yu &lt;- y[y &gt;= quantile(y)[2] &amp; y &lt;= quantile(y)[4]]
geno.s &lt;- geno[y &gt; quantile(y)[4] | y &lt; quantile(y)[2],]

# run and result
QTL &lt;- c(1, 23)
result &lt;- MIM.search2(QTL, marker, geno.s, ys, yu, sele.g = "f",
 type = "RI", ng = 2, speed = 15, QTLdist = 50)
result$QTL.best
result$effect.best
</code></pre>


</div>